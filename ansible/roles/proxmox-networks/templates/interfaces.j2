# network interface settings; autogenerated
# Please do NOT modify this file directly, unless you know what
# you're doing.
#
# If you want to manage parts of the network configuration manually,
# please utilize the 'source' or 'source-directory' directives to do
# so.
# PVE will preserve these directives, but will NOT read its network
# configuration from sourced files, so do not attempt to move any of
# the PVE managed interfaces into external files!

# {{ ansible_managed }}

auto lo
iface lo inet loopback

{% for interface in proxmox_external_bridge_interfaces %}
iface {{ interface }} inet manual
{% endfor %}

{% if proxmox_private_network_present %}
auto {{ proxmox_private_network_ifname }}
{% if proxmox_private_network_ipv4.present %}
iface {{ proxmox_private_network_ifname }} inet static
        address {{ proxmox_private_network_ipv4.address }}
        bridge-ports {{ proxmox_private_network_bridge_interfaces|join(" ") }}
        bridge-stp off
        bridge-fd 0
        bridge-vlan-aware yes
        bridge-vids 2-4094
#internal-only
{% endif %}{% if proxmox_private_network_ipv6.present %}
iface {{ proxmox_private_network_ifname }} inet6 static
        address {{ proxmox_private_network_ipv6.address }}
{% endif %}{% endif %}

{% if proxmox_nat_network_present %}
auto {{ proxmox_nat_network_ifname }}
{% if proxmox_nat_network_ipv4.present %}
iface {{ proxmox_nat_network_ifname }} inet static
        address {{ proxmox_nat_network_ipv4.address }}
        bridge-ports {{ proxmox_nat_network_bridge_interfaces|join(" ") }}
        bridge-stp off
        bridge-fd 0
{% endif %}{% if proxmox_nat_network_ipv6.present %}
iface {{ proxmox_nat_network_ifname }} inet6 static
        address {{ proxmox_nat_network_ipv6.address }}
{% endif %}{% endif %}

{% if proxmox_public_network_present %}
auto {{ proxmox_public_network_ifname }}
{% if proxmox_public_network_ipv4.present %}
iface {{ proxmox_public_network_ifname }} inet static
        address {{ proxmox_public_network_ipv4.address }}
        gateway {{ proxmox_public_network_ipv4.gateway }}
        bridge-ports {{ proxmox_public_network_bridge_interfaces|join(" ") }}
        bridge-stp off
        bridge-fd 0
{% endif %}{% if proxmox_public_network_ipv6.present %}
iface {{ proxmox_public_network_ifname }} inet6 static
        address {{ proxmox_public_network_ipv6.address }}
        gateway {{ proxmox_public_network_ipv6.gateway }}
{% endif %}{% endif %}
